<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8">
<title>KANPOD WorkStation</title>
<meta name="description" content="Page Title">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no, minimal-ui">
<!-- Call App Mode on ios devices -->
<meta name="apple-mobile-web-app-capable" content="yes" />
<!-- Remove Tap Highlight on Windows Phone IE -->
<meta name="msapplication-tap-highlight" content="no">
<!-- base css -->
<link rel="stylesheet" media="screen, print" href="css/vendors.bundle.css">
<link rel="stylesheet" media="screen, print" href="css/app.bundle.css">
<!--<link rel="stylesheet" media="screen, print" href="css/themes/cust-theme-3.css">-->
<link rel="stylesheet" media="screen, print" href="css/fa-brands.css">
<link rel="stylesheet" media="screen, print" href="css/fa-regular.css">
<link rel="stylesheet" media="screen, print" href="css/fa-duotone.css">
<link rel="stylesheet" media="screen, print" href="css/fa-solid.css">
<link rel="stylesheet" media="screen, print" href="css/datagrid/datatables/datatables.bundle.css">

</head>
<body >

<!-- BEGIN Page Wrapper -->
<div class="page-wrapper">
  <div class="page-inner"> 
    <!-- BEGIN Left Aside --> 
    
    <!-- END Left Aside -->
    <div class="page-content-wrapper"> 
      <!-- BEGIN Page Header -->

      <main id="js-page-contentmain" role="main" class="page-content p-0 bg-gray-900"> 

        <div class="row  d-flex flex-grow-1 p-0 ">

          <div class="col-12 col-md-12 col-lg-12 col-xl-12 p-0 ">
            <div class="row " style="margin: 0px 0px" id="js-page-content"> 

            </div>
          </div>
        </div>
        
        <!-- Your main content goes below here: --> 
        
      </main>

      <div class="page-content-overlay" data-action="toggle" data-class="mobile-nav-on"></div>

      <p id="js-color-profile" class="d-none"> <span class="color-primary-50"></span> <span class="color-primary-100"></span> <span class="color-primary-200"></span> <span class="color-primary-300"></span> <span class="color-primary-400"></span> <span class="color-primary-500"></span> <span class="color-primary-600"></span> <span class="color-primary-700"></span> <span class="color-primary-800"></span> <span class="color-primary-900"></span> <span class="color-info-50"></span> <span class="color-info-100"></span> <span class="color-info-200"></span> <span class="color-info-300"></span> <span class="color-info-400"></span> <span class="color-info-500"></span> <span class="color-info-600"></span> <span class="color-info-700"></span> <span class="color-info-800"></span> <span class="color-info-900"></span> <span class="color-danger-50"></span> <span class="color-danger-100"></span> <span class="color-danger-200"></span> <span class="color-danger-300"></span> <span class="color-danger-400"></span> <span class="color-danger-500"></span> <span class="color-danger-600"></span> <span class="color-danger-700"></span> <span class="color-danger-800"></span> <span class="color-danger-900"></span> <span class="color-warning-50"></span> <span class="color-warning-100"></span> <span class="color-warning-200"></span> <span class="color-warning-300"></span> <span class="color-warning-400"></span> <span class="color-warning-500"></span> <span class="color-warning-600"></span> <span class="color-warning-700"></span> <span class="color-warning-800"></span> <span class="color-warning-900"></span> <span class="color-success-50"></span> <span class="color-success-100"></span> <span class="color-success-200"></span> <span class="color-success-300"></span> <span class="color-success-400"></span> <span class="color-success-500"></span> <span class="color-success-600"></span> <span class="color-success-700"></span> <span class="color-success-800"></span> <span class="color-success-900"></span> <span class="color-fusion-50"></span> <span class="color-fusion-100"></span> <span class="color-fusion-200"></span> <span class="color-fusion-300"></span> <span class="color-fusion-400"></span> <span class="color-fusion-500"></span> <span class="color-fusion-600"></span> <span class="color-fusion-700"></span> <span class="color-fusion-800"></span> <span class="color-fusion-900"></span> </p>

    </div>
  </div>
</div>

<script src="js/vendors.bundle.js"></script> 
<script src="js/app.bundle.js"></script> 
<script src="js/dependency/moment/moment.js"></script> 
<script src="js/statistics/peity/peity.bundle.js"></script> 
<script src="js/statistics/sparkline/sparkline.bundle.js"></script> 
<script src="js/handlebars-v4.7.3.js"></script> 
<script src="js/moment.js"></script> 
<script type="text/javascript" src="js/echarts.min.js"></script> 
<script type="text/javascript">
            // push settings with "false" save to local
            initApp.pushSettings("nav-function-minify layout-composed", false);

        </script> 
<script id="template" type="text/x-handlebars-template">
<div  class="col-12 p-6" style="padding: 0px 12px">
    
		 <table class="table text-white table-bordered" style="table-layout:fixed;overflow:auto">
		  <tr>
			<td  style="font-size: 1em; width:100px">提单人：</td>
			<td  style="font-size: 1em; width:180px">{{data.public_initiatorName}}</td>
			<td  style="font-size: 1em; width:100px">部门：</td>
			<td  style="font-size: 1em; width:180px">{{data.public_department}}</td>
			<td  style="font-size: 1em; width:100px">提单时间：</td>
			<td  style="font-size: 1em; width:180px">{{data.public_createTime}}</td>
			<td  style="font-size: 1em; width:100px">偏差类型：</td>
			<td  style="font-size: 1em; width:180px">{{data.deviationType}}</td>
		  </tr>
		  <tr>
			<td  style="font-size: 1em; width:100px">产品线：</td>
			<td  style="font-size: 1em; width:180px">{{data.productLine}}</td>
			<td  style="font-size: 1em; width:100px">零件号：</td>
			<td  style="font-size: 1em; width:180px">{{data.partNumbers}}</td>
			<td  style="font-size: 1em; width:100px">申请零件及数量：</td>
			<td  style="font-size: 1em; width:180px">{{data.partsAndQuantity}}</td>
			<td  style="font-size: 1em; width:100px">申请内容：</td>
			<td  style="font-size: 1em; width:180px">{{data.ApplyContent}}</td>
		  </tr>
		  <tr>
			<td  style="font-size: 1em; width:100px">成品试用结果：</td>
			<td  style="font-size: 1em; width:180px">{{data.trialResults}}</td>
			<td  style="font-size: 1em; width:100px">贷款扣除比例：</td>
			<td  style="font-size: 1em; width:180px">{{data.proportion}}</td>
			<td  style="font-size: 1em; width:100px">是否扣款：</td>
			<td  style="font-size: 1em; width:180px">{{data.deduction}}</td>
			<td  style="font-size: 1em; width:100px">纠正方案：</td>
			<td  style="font-size: 1em; width:180px">{{data.correctPlan}}</td>
		  </tr>

		  <tr>
			<td  style="font-size: 1em; width:100px">拍照上传：</td>
			<td  style="font-size: 1em; width:180px" colspan="7">{{#each photographDetails}}
			<img style="width:200px" src={{url}} ref="fileImage">
			{{/each}}</td>

		  </tr>
		</table>
</div>
   
</script> 
<script type="text/javascript">
	

	//设置时间
	var current_datetime = new Date();
	var formatted_date = moment(new Date().getTime()).format("YYYY-MM-DD HH:mm:ss");
	$('#refreshTime').text(formatted_date)

	//获取sn参数
	function getQueryVariable(variable)
	{
		   var query = window.location.search.substring(1);
		   var vars = query.split("&");
		   for (var i=0;i<vars.length;i++) {
				   var pair = vars[i].split("=");
				   if(pair[0] == variable){return pair[1];}
		   }
		   return(false);
	}

	var sn = (getQueryVariable("sn") === false ? "178646d7f2f69dac" : getQueryVariable("sn"));	
	
	//从metabase获取数据并展示

	var metabaseUrl = "https://mttmb.magna.cn/public/question/0e3bf9a9-d496-4550-bb5a-b786e2fd5084.json";//偏差单
	var getDataSettings = {
	  "url": metabaseUrl + "?parameters=[{\"type\":\"category\",\"target\":[\"variable\",[\"template-tag\",\"sn\"]],\"value\":\"" + sn + "\"}]",
	  "method": "GET"
	}	
	$.ajax(getDataSettings).done(function (response) {
		if(response[0]){
		

			var renderData = {"data" : response[0], "photographDetails": JSON.parse(response[0].photograph)}
			
			var template = document.getElementById('template').innerHTML;
			
			var rendered = Handlebars.compile(template);
			document.getElementById('js-page-content').innerHTML = rendered(renderData);		
		}

		
	});




 
</script> 

<!--This page contains the basic JS and CSS files to get started on your project. If you need aditional addon's or plugins please see scripts located at the bottom of each page in order to find out which JS/CSS files to add.-->
</body>
</html>
