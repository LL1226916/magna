(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5fef8cd5"],{"3ca3":function(t,e,a){"use strict";var s=a("6547").charAt,i=a("69f3"),r=a("7dd0"),n="String Iterator",l=i.set,o=i.getterFor(n);r(String,"String",(function(t){l(this,{type:n,string:String(t),index:0})}),(function(){var t,e=o(this),a=e.string,i=e.index;return i>=a.length?{value:void 0,done:!0}:(t=s(a,i),e.index+=t.length,{value:t,done:!1})}))},"79e0":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-flex flex-grow-1 p-0"},[a("div",{staticClass:"d-flex flex-column flex-grow-1 bg-white"},[a("div",{staticClass:"flex-grow-0"}),a("div",{staticClass:"flex-wrap align-items-center flex-grow-1 position-relative bg-gray-50"},[a("div",{staticClass:"position-absolute pos-top pos-bottom w-100 custom-scroll"},[a("div",{staticClass:"d-flex h-100 flex-column"},t._l(t.tasks,(function(e){return a("div",{key:e.id,staticClass:"d-flex flex-column border-faded border-top-0 border-left-0 border-right-0 py-3 px-3 px-sm-4 px-lg-0 mr-0 mr-lg-5 flex-shrink-0",attrs:{id:"task"+e.id}},[a("div",{staticClass:"d-flex align-items-center flex-row"},[a("div",{staticClass:"ml-0 mr-3 mx-lg-4"},[a("i",{staticClass:"far fa-2x fa-fw",class:{"fa-alarm-exclamation":e.isDue&&!e.isDisabled,"text-danger":e.isDue&&!e.isDisabled,"fa-ban":e.isDisabled,"text-default":e.isDisabled,"fa-calendar-check":!e.isDue&&!e.isDisabled,"text-success":!e.isDue&&!e.isDisabled}})]),a("div",{staticClass:"fw-500 flex-1 d-flex flex-column cursor-pointer",attrs:{"data-toggle":"collapse","data-target":"#task"+e.id+" > .js-collapse"}},[a("div",{staticClass:"fs-sm"},[a("span",{staticClass:"fw-900 color-black"},[t._v(t._s(e.name))])]),a("div",{staticClass:"fs-xs fw-300 text-dark mt-1"},[t._v(t._s(e.instance&&e.instance.businessKey))])]),a("div",{staticClass:"color-fusion-200 fs-sm",staticStyle:{"text-align":"right"}},[a("span",{staticClass:"text-primary",style:{visibility:e.dueDate?"visible":"hidden"}},[a("i",{staticClass:"fal fa-fw fa-bell mr-1"}),t._v(" "+t._s(t.moment(e.dueDate).format("YYYY-MM-DD"))+" "),a("strong",[t._v(t._s(t.moment(e.dueDate).format("HH:mm")))])])])]),a("div",{staticClass:"collapse js-collapse"},[a("div",{staticClass:"pl-lg-5 ml-lg-5 pt-3 pb-4 mt-0"},[a("div",{staticClass:"row color-black panel-tag bg-light color-black ml-0 mt-0 mb-0 fs-xs"},[a("div",{staticClass:"col-6 mb-2"},[a("span",{staticClass:"fw-400 text-black-50"},[t._v("指派日期")]),a("span",{staticClass:"fw-900 d-block",style:{visibility:"visible"}},[t._v(t._s(t.moment(e.createTime).format("YYYY-MM-DD")))])]),a("div",{staticClass:"col-6 mb-2"},[a("span",{staticClass:"fw-400 text-black-50"},[t._v("到期日期")]),a("span",{staticClass:"fw-900 d-block",style:{visibility:e.dueDate?"visible":"hidden"}},[t._v(t._s(t.moment(e.dueDate).format("YYYY-MM-DD")))])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.saveDate,expression:"task.saveDate"}],staticClass:"col-6 mb-2"},[a("span",{staticClass:"fw-400 text-black-50"},[t._v("上次保存日期")]),a("span",{staticClass:"fw-900 d-block"},[t._v(t._s(t.moment(e.saveDate).format("YYYY-MM-DD HH:mm")))])]),t._m(0,!0),a("div",{staticClass:"col-6 mt-2"},[a("a",{staticClass:"fw-300 btn btn-sm",class:{"btn-danger":e.isDue&&!e.isDisabled,"btn-default disabled":e.isDisabled,"btn-success":!e.isDue&&!e.isDisabled},attrs:{href:"javascript:void(0);"},on:{click:function(a){return t.selectTask(e)}}},[a("i",{staticClass:"fad fa-fw fa-share-all mr-2"}),t._v("执行任务 ")])])])])])])})),0)])])])])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-12 mb-2"},[a("div",{staticClass:"dropdown-divider"})])}],r=(a("7db0"),a("4160"),a("d81d"),a("d3b7"),a("3ca3"),a("159b"),a("ddb0"),a("a49b")),n=a("90b9"),l=a("f523"),o=a("f817"),d={data:function(){return n["a"].createModel({moment:o["a"],config:r["a"],tasks:[]})},created:function(){var t=this,e=this.user.id,a=[];l["a"].requestBpmn("runtime/tasks","",{assignee:e,active:!0,nameLike:"%lpa%",size:500}).then((function(t){var e=Object(o["a"])();a=t.data.data,a.forEach((function(t,a){var s=t.dueDate&&Object(o["a"])(t.dueDate);t.isDue=s&&s.isBefore(e),t.isDisabled=s&&s.diff(e,"minutes")>r["a"].taskAdvance}));var s=a.map((function(t){return l["a"].requestBpmn("history/historic-process-instances/"+t.processInstanceId)}));return Promise.all(s)})).then((function(e){console.log(e),e.forEach((function(t){var e=t.data.id,s=a.find((function(t){return t.processInstanceId===e}));s.instance=t.data})),t.tasks=a,"desktop"===myapp_config.thisDevice&&$(".custom-scroll:not(.disable-slimscroll) >:first-child").slimscroll({height:$(t).data("scrollHeight")||"100%",size:$(t).data("scrollSize")||"4px",position:$(t).data("scrollPosition")||"right",color:$(t).data("scrollColor")||"rgba(0,0,0,0.6)",alwaysVisible:$(t).data("scrollAlwaysVisible")||!1,distance:$(t).data("scrollDistance")||"4px",railVisible:$(t).data("scrollRailVisible")||!1,railColor:$(t).data("scrollRailColor")||"#fafafa",allowPageScroll:!1,disableFadeOut:!1})}))},mounted:function(){},methods:{selectTask:function(t){t.isDisabled||this.$router.push({name:"task",query:{id:t.id}})}}},c=d,u=a("2877"),f=Object(u["a"])(c,s,i,!1,null,"24105ace",null);e["default"]=f.exports},f523:function(t,e,a){"use strict";a("4de4"),a("7db0"),a("4160"),a("c975"),a("d81d"),a("b0c0"),a("d3b7"),a("3ca3"),a("498a"),a("159b"),a("ddb0");var s=a("a49b"),i=a("bc3a"),r=a.n(i),n=a("323e"),l=a.n(n);r.a.interceptors.request.use((function(t){return l.a.start(),t})),r.a.interceptors.response.use((function(t){return l.a.done(),t}),(function(t){return l.a.done(),Promise.reject(t.response)})),e["a"]={getUsers:function(t){var e=this,a=t.map((function(t){return e.requestBpmn("identity/users/"+t)}));return Promise.all(a)},getItem:function(t,e){var a,i=this,n=s["a"][t+"Url"];return r.a.get(n+e).then((function(t){a=t;var e=a.data,s=[];return e.createdBy&&s.indexOf(e.createdBy)<0&&s.push(e.createdBy),e.updatedBy&&s.indexOf(e.updatedBy)<0&&s.push(e.updatedBy),i.getUsers(s)})).then((function(t){var e=a.data,s=t.map((function(t){return t.data}));if(e.createdBy){var i=s.find((function(t){return t.id.toLowerCase()===e.createdBy.toLowerCase()}));e.createdName=(i.firstName+" "+i.lastName).trim()}return e.updatedBy&&(i=s.find((function(t){return t.id.toLowerCase()===e.updatedBy.toLowerCase()})),e.updatedName=(i.firstName+" "+i.lastName).trim()),Promise.resolve(a)}))},getItems:function(t,e){var a=this,i=s["a"][t+"Url"];return new Promise((function(s,n){e=e||{},e.filter=e.filter||{},e.filter.type=t,e.filter=JSON.stringify(e.filter),e.sort&&(e.sort=JSON.stringify(e.sort));var l={dataType:"json",url:i,method:"get",params:e},o=[];return r()(l).then((function(t){o=t.data._embedded;var e=[];return o.forEach((function(t){t.createdBy&&e.indexOf(t.createdBy)<0&&e.push(t.createdBy),t.updatedBy&&e.indexOf(t.updatedBy)<0&&e.push(t.updatedBy)})),a.getUsers(e)})).then((function(t){o.forEach((function(e){var a=t.map((function(t){return t.data}));if(e.createdBy){var s=a.find((function(t){return t.id.toLowerCase()===e.createdBy.toLowerCase()}));e.createdName=(s.firstName+" "+s.lastName).trim()}e.updatedBy&&(s=a.find((function(t){return t.id.toLowerCase()===e.updatedBy.toLowerCase()})),e.updatedName=(s.firstName+" "+s.lastName).trim())})),s(o)}))}))},saveItem:function(t,e){return this.getItems(t,{filter:{name:e.name,_id:{$ne:e._id}}}).then((function(a){return a&&a.length?Promise.reject({message:'名称"'+e.name+'"已存在。'}):r()({dataType:"json",url:s["a"][t+"Url"],headers:{"Content-Type":"application/json"},method:"post",data:e})}))},deleteItem:function(t,e){var a=s["a"][t+"Url"];a+=e;var i={dataType:"text",url:a,method:"delete",data:{}};return r()(i)},requestBpmn:function(t,e,a){e=e||"GET";var i=s["a"].bpmnUrl+(t||""),n={dataType:"json",url:i,headers:{Authorization:sessionStorage.getItem("token"),"Content-Type":"application/json"},method:e};return"GET"===e?n.params=a:n.data=a,r()(n)},upload:function(t){return r()({method:"post",url:s["a"].uploadUrl+"upload",data:t,headers:{"Content-Type":"multipart/form-data"}})},getProcessTemplate:function(t){return r()({method:"get",url:"template/"+t+".bpmn",headers:{"Content-Type":"text"}})}}}}]);
//# sourceMappingURL=chunk-5fef8cd5.afb3c31a.js.map